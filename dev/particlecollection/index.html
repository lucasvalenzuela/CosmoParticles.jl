<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Particle Collections · CosmoParticles.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://lucasvalenzuela.github.io/CosmoParticles.jl/particlecollection/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CosmoParticles.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../particles/">Particles</a></li><li class="is-active"><a class="tocitem" href>Particle Collections</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#All-Particles"><span>All Particles</span></a></li></ul></li><li><a class="tocitem" href="../operations/">Operations</a></li><li><a class="tocitem" href="../properties/">Properties</a></li><li><a class="tocitem" href="../geometry/">Geometry</a></li><li><a class="tocitem" href="../utils/">Utils</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Particle Collections</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Particle Collections</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/master/docs/src/particlecollection.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Particle-Collections"><a class="docs-heading-anchor" href="#Particle-Collections">Particle Collections</a><a id="Particle-Collections-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Collections" title="Permalink"></a></h1><p>A set of different particles are represented by subtypes of <code>AbstractParticleCollection</code>. These can have a cosmological redshift attributed to them. In the context of cosmological simulations, this applies to collections of DM, gas, and star particles.</p><p>For an example implementation of a concrete subtype of <code>AbstractParticleCollection</code>, see the source codes of <a href="#CosmoParticles.ParticleCollection"><code>ParticleCollection</code></a> or <a href="#CosmoParticles.RedshiftParticleCollection"><code>RedshiftParticleCollection</code></a>.</p><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.AbstractParticleCollection" href="#CosmoParticles.AbstractParticleCollection"><code>CosmoParticles.AbstractParticleCollection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractParticleCollection{AP} end</code></pre><p>Abstract supertype for storing data of multiple particle types.</p><p>The particles are expected to be stored in a <code>Dict{Symbol,&lt;:AbstractParticles}</code>.</p><p>The inbuilt functionality of <code>AbstractParticleCollection</code> includes accessing and setting properties via the following syntax:</p><pre><code class="language-julia hljs">P&lt;:AbstractParticles
pc::&lt;:AbstractParticleCollection{P}
p::&lt;:P
pc.dm = p
pc[:dm] === p</code></pre><p>In addition, the following syntax is equivalent to creating an <a href="#CosmoParticles.AllParticles"><code>AllParticles</code></a> object: <code>pc.all</code>. The syntax <code>pc[:all]</code> is not valid, however.</p><p>If the struct has additional fields, these can also be accessed by <code>pc.field</code>, but not by <code>pc[:field]</code>. The latter syntax can only be used to access the particles.</p><p><strong>Methods</strong></p><p>The methods <code>Base.keys</code>, <code>Base.values</code>, <code>Base.haskey</code>, <code>Base.empty</code>, <code>Base.empty!</code>, <code>Base.isempty</code>, and <code>Base.copy!</code> are forwarded to the particle <code>Dict</code>.</p><p>Concrete types of <code>AbstractParticleCollection</code> should have the following methods implemented (also see the implementation of <a href="#CosmoParticles.ParticleCollection"><code>ParticleCollection</code></a>):</p><ul><li><code>Base.copy</code>: returns new object containing a copy of the <code>Dict</code></li><li><code>Base.empty</code>: returns an identical object, but with an empty <code>Dict</code></li><li><code>Base.:(==)</code></li><li><a href="#CosmoParticles.redshift"><code>redshift</code></a>: implement this if the redshift of the particle collection is non-zero</li><li><code>Base.propertynames</code>: implement this if there are additional struct fields</li><li><code>Base.show(io, mime, pc)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/abstractparticlecollection.jl#L1-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.ParticleCollection" href="#CosmoParticles.ParticleCollection"><code>CosmoParticles.ParticleCollection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct ParticleCollection{AP&lt;:AbstractParticles} &lt;: AbstractParticleCollection{AP}
    particles::Dict{Symbol,AP}
end</code></pre><p>Basic particle collection at redshift 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.ParticleCollection-Tuple{Type{&lt;:AbstractParticles}}" href="#CosmoParticles.ParticleCollection-Tuple{Type{&lt;:AbstractParticles}}"><code>CosmoParticles.ParticleCollection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ParticleCollection(::Type{AP}=Particles) where {AP&lt;:AbstractParticles}</code></pre><p>Create an empty particle collection of the passed type.</p><p>By default, the particle collection is created for the [<code>Particles</code>] type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L12-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.ParticleCollection-Union{Tuple{Vararg{Pair{Symbol, AP}}}, Tuple{AP}} where AP&lt;:AbstractParticles" href="#CosmoParticles.ParticleCollection-Union{Tuple{Vararg{Pair{Symbol, AP}}}, Tuple{AP}} where AP&lt;:AbstractParticles"><code>CosmoParticles.ParticleCollection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ParticleCollection(pairs::Pair{Symbol,AP}...) where {AP&lt;:AbstractParticles}</code></pre><p>Create a particle collection from pairs of Symbols and particles.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">ParticleCollection(:dm =&gt; Particles(:dm), :gas =&gt; Particles(:gas))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L22-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.ParticleCollection-Tuple{Particles, Vararg{Particles}}" href="#CosmoParticles.ParticleCollection-Tuple{Particles, Vararg{Particles}}"><code>CosmoParticles.ParticleCollection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ParticleCollection(p::Particles...)</code></pre><p>Create a particle collection from multiple <a href="../particles/#CosmoParticles.Particles"><code>Particles</code></a>.</p><p>The <code>Dict</code> keys are taken from the <a href="../particles/#CosmoParticles.Particles"><code>Particles</code></a> type.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">ParticleCollection(Particles(:dm), Particles(:gas))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L36-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.RedshiftParticleCollection" href="#CosmoParticles.RedshiftParticleCollection"><code>CosmoParticles.RedshiftParticleCollection</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct RedshiftParticleCollection{AP&lt;:AbstractParticles,T&lt;:Real} &lt;: AbstractParticleCollection{AP}
    z::T
    particles::Dict{Symbol,AP}
end</code></pre><p>Particle collection at a given redshift.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L67-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.RedshiftParticleCollection-Tuple{Type{&lt;:AbstractParticles}, Real}" href="#CosmoParticles.RedshiftParticleCollection-Tuple{Type{&lt;:AbstractParticles}, Real}"><code>CosmoParticles.RedshiftParticleCollection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RedshiftParticleCollection([::Type{AP}=Particles,] z::T) where {AP&lt;:AbstractParticles,T&lt;:Real}</code></pre><p>Create an empty particle collection of the passed type at redshift <code>z</code>.</p><p>By default, the particle collection is created for the [<code>Particles</code>] type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L80-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.RedshiftParticleCollection-Union{Tuple{T}, Tuple{AP}, Tuple{T, Vararg{Pair{Symbol, AP}}}} where {AP&lt;:AbstractParticles, T&lt;:Real}" href="#CosmoParticles.RedshiftParticleCollection-Union{Tuple{T}, Tuple{AP}, Tuple{T, Vararg{Pair{Symbol, AP}}}} where {AP&lt;:AbstractParticles, T&lt;:Real}"><code>CosmoParticles.RedshiftParticleCollection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RedshiftParticleCollection(z::T, pairs::Pair{Symbol,AP}...) where {AP&lt;:AbstractParticles,T&lt;:Real}</code></pre><p>Create a particle collection at redshift <code>z</code> from pairs of Symbols and particles.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">RedshiftParticleCollection(0.5, :dm =&gt; Particles(:dm), :gas =&gt; Particles(:gas))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L94-L103">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.RedshiftParticleCollection-Tuple{Real, Particles, Vararg{Particles}}" href="#CosmoParticles.RedshiftParticleCollection-Tuple{Real, Particles, Vararg{Particles}}"><code>CosmoParticles.RedshiftParticleCollection</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RedshiftParticleCollection(z::Real, p::Particles...)</code></pre><p>Create a particle collection at redshift <code>z</code> from multiple <a href="../particles/#CosmoParticles.Particles"><code>Particles</code></a>.</p><p>The <code>Dict</code> keys are taken from the <a href="../particles/#CosmoParticles.Particles"><code>Particles</code></a> type.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">RedshiftParticleCollection(0.5, Particles(:dm), Particles(:gas))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/particlecollection.jl#L108-L119">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.redshift" href="#CosmoParticles.redshift"><code>CosmoParticles.redshift</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">redshift(pc::AbstractParticleCollection) = 0</code></pre><p>Returns the redshift at which the particles are located.</p><p>By default, 0 is returned. This method should be overridden for concrete types of <code>AbstractParticleCollection</code> for which the redshift differs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/abstractparticlecollection.jl#L90-L97">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.get_particles" href="#CosmoParticles.get_particles"><code>CosmoParticles.get_particles</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_particles(pc::AbstractParticleCollection)</code></pre><p>Return the particles <code>Dict</code> belonging to the particle collection.</p><p>This returns <code>pc.particles</code> by default if not overridden.</p><p>This is not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/abstractparticlecollection.jl#L39-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.show_properties-Tuple{IO, AbstractString, AbstractParticleCollection}" href="#CosmoParticles.show_properties-Tuple{IO, AbstractString, AbstractParticleCollection}"><code>CosmoParticles.show_properties</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">CosmoParticles.show_properties(io::IO, mime, p::AbstractParticleCollection)</code></pre><p>Prints the properties of the particles in the collection.</p><p>Should be used internally when overriding <code>Base.show</code> for concrete implementations of <code>AbstractParticleCollection</code>.</p><p>This is not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/abstractparticlecollection.jl#L100-L109">source</a></section></article><h1 id="All-Particles"><a class="docs-heading-anchor" href="#All-Particles">All Particles</a><a id="All-Particles-1"></a><a class="docs-heading-anchor-permalink" href="#All-Particles" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.AllParticles" href="#CosmoParticles.AllParticles"><code>CosmoParticles.AllParticles</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AllParticles{APC} &lt;: AbstractParticles where {APC&lt;:AbstractParticleCollection}</code></pre><p>Combines the particles of different types from a particle collection lazily.</p><p>The property arrays of the collection&#39;s particles are concatenated lazily with <a href="https://github.com/JuliaArrays/LazyArrays.jl">LazyArrays.jl</a>. Scalar properties (e.g. mass for equal-mass particles) are repeated according to the particle number of the given particle type with <a href="https://github.com/JuliaArrays/FillArrays.jl">FillArrays.jl</a>. Properties that only exist for one of the particle types are repeated as <code>missing</code> values in the same way as scalar properties.</p><p><strong>Usage</strong></p><p>The individual properties of <code>AllParticles</code> can be converted as regular arrays with <code>Array(ap.pos)</code> and all or selected particle properties can be converted to a <code>Particles</code> object with <code>Particles(ap)</code>, where all lazy arrays are materialized as <code>Array</code>s. <code>AllParticles</code> cannot be sorted, filtered, or copied. In-place modifications are possible, such as <a href="../operations/#LinearAlgebra.rotate!"><code>rotate!</code></a>, <a href="../operations/#CosmoParticles.translate!"><code>translate!</code></a>, or <a href="../operations/#CosmoParticles.to_comoving"><code>to_comoving</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">In-place modifications</header><div class="admonition-body"><p>Modifying an <code>AllParticles</code> object in-place results in the modification of the underlying particle collection! To prevent bugs or unexpected behavior, it is advised to modify the particle collection instead and then obtain the object through <code>pc.all</code> or <code>AllParticles(pc)</code> (these are equivalent).</p></div></div><p>The lazy concatenation occurs only when the property is needed and is only performed once. Note that this means that calling <code>pc.all.prop</code> multiple times results in the given property being lazily concatenated every time. As long as the property array pointers of the particle collection are not modified (e.g. by <code>sort!</code> or <code>filter!</code>), it is possible to reuse an object <code>ap = pc.all</code> without the need of regenerating the concatenated arrays.</p><div class="admonition is-warning"><header class="admonition-header">Modifying the underlying particle collection</header><div class="admonition-body"><p>After modifying the property array pointers of a particle collection (e.g. by <code>sort!</code> or <code>filter!</code>), any already created <code>AllParticles</code> objects from that collection may have lazy arrays pointing to the old, non-modified arrays. When this happens, create a new object through <code>pc.all</code> or <code>AllParticles(pc)</code>.</p></div></div><p><strong>Example</strong></p><pre><code class="language-julia hljs">julia&gt; pc::ParticleCollection
ParticleCollection
dm: 100 Particles
 id mass pos
gas: 50 Particles
 id mass pos temp

julia&gt; ap = AllParticles(pc) # equivalent to ap = pc.all
all: 150 Particles
 id mass pos temp

julia&gt; p = Particles(ap) # p is detached from pc and therefore modifiable
all: 150 Particles
 id mass pos temp

julia&gt; sort!(p, :id)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/allparticles.jl#L1-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CosmoParticles.particle_collection" href="#CosmoParticles.particle_collection"><code>CosmoParticles.particle_collection</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">particle_collection(p::AllParticles)</code></pre><p>Returns the underlying particle collection.</p><p>This is not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/allparticles.jl#L64-L70">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.copy!" href="#Base.copy!"><code>Base.copy!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.copy!(dst::AbstractParticles, src::AllParticles[, props])</code></pre><p>Copies the materialized particle properties to another particle object.</p><p>To only copy certain properties, <code>props</code> can be passed as a vector of <code>Symbol</code>s. The <code>dst</code> cannot be of type <code>AllParticles</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucasvalenzuela/CosmoParticles.jl/blob/3552d6686e5624d0b505cb3a5779e4b9c6e3035a/src/allparticles.jl#L168-L175">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../particles/">« Particles</a><a class="docs-footer-nextpage" href="../operations/">Operations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Saturday 5 February 2022 15:45">Saturday 5 February 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
